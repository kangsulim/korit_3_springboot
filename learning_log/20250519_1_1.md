
## âœ… ë³€ê²½ëœ `filterChain` ë©”ì„œë“œ êµ¬ì¡° ë¶„ì„

```java
@Bean
public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
    http.csrf((csrf) -> csrf.disable())                       // 1. CSRF ë¹„í™œì„±í™”
        .cors(withDefaults())                                 // 2. CORS ì„¤ì • ì¶”ê°€
        .sessionManagement((sessionManagement) ->
            sessionManagement.sessionCreationPolicy(SessionCreationPolicy.STATELESS)) // 3. ì„¸ì…˜ ì‚¬ìš© ì•ˆ í•¨
        .authorizeHttpRequests((authorizeRequests) ->
            authorizeRequests.requestMatchers(HttpMethod.POST, "/login")
                .permitAll()
                .anyRequest().authenticated())                // 4. ë¡œê·¸ì¸ ì™¸ì—ëŠ” ì¸ì¦ í•„ìš”
        .addFilterBefore(authenticationFilter, UsernamePasswordAuthenticationFilter.class) // 5. JWT í•„í„° ì¶”ê°€
        .exceptionHandling((exceptionHandling) ->
            exceptionHandling.authenticationEntryPoint(exceptionHandler)); // 6. ì¸ì¦ ì˜ˆì™¸ ì²˜ë¦¬

    return http.build();
}
```

---

## ğŸ” ì£¼ìš” ë³€ê²½ì  ì„¤ëª…

### 1. `cors(withDefaults())` â€“ **CORS ì„¤ì •**

* **CORS(Cross-Origin Resource Sharing)**: ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œ ìš”ì²­í•  ë•Œ ë³´ì•ˆì„ ìœ„í•´ ì œì•½ì´ ê±¸ë¦¬ëŠ” í˜„ìƒ.
* ì´ ì¤„ì€ êµì°¨ ì¶œì²˜ ìš”ì²­ì„ í—ˆìš©í•©ë‹ˆë‹¤.
* ì˜ˆ: í”„ë¡ íŠ¸ì—”ë“œê°€ `http://localhost:3000`, ë°±ì—”ë“œëŠ” `http://localhost:8080`ì¼ ë•Œ ì´ ì„¤ì •ì´ ì—†ìœ¼ë©´ ìš”ì²­ ì°¨ë‹¨ë©ë‹ˆë‹¤.

---

### 2. `addFilterBefore(authenticationFilter, UsernamePasswordAuthenticationFilter.class)`

* `authenticationFilter`: ë³´í†µ **JWT í† í°ì„ ê²€ì‚¬í•˜ëŠ” ì»¤ìŠ¤í…€ í•„í„°**ì…ë‹ˆë‹¤.
* `UsernamePasswordAuthenticationFilter` **ì´ì „ì— ì‹¤í–‰**ë˜ë„ë¡ ì„¤ì •í•´, ìš”ì²­ì—ì„œ í† í°ì„ êº¼ë‚´ ê²€ì¦í•©ë‹ˆë‹¤.
* ì—­í• :

    * ìš”ì²­ í—¤ë”ì—ì„œ JWT í† í°ì„ ì¶”ì¶œ
    * ìœ íš¨í•˜ë©´ `SecurityContext`ì— ì¸ì¦ ì •ë³´ ì„¤ì •

ğŸ”§ ì´ í•„í„°ëŠ” ê°œë°œìê°€ ì§ì ‘ ë§Œë“  í´ë˜ìŠ¤ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:

```java
public class JwtAuthenticationFilter extends OncePerRequestFilter {
    ...
}
```

---

### 3. `exceptionHandling().authenticationEntryPoint(exceptionHandler)`

* `exceptionHandler`: ì¸ì¦ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬í•˜ëŠ” **ì»¤ìŠ¤í…€ ì˜ˆì™¸ í•¸ë“¤ëŸ¬**ì…ë‹ˆë‹¤.
* ì˜ˆ: JWTê°€ ì—†ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì€ ê²½ìš°, ìë™ìœ¼ë¡œ 401 Unauthorized ì‘ë‹µì„ ë°˜í™˜

```java
public class AuthEntryPoint implements AuthenticationEntryPoint {
    @Override
    public void commence(HttpServletRequest request, HttpServletResponse response,
                         AuthenticationException authException) throws IOException {
        response.sendError(HttpServletResponse.SC_UNAUTHORIZED, "Unauthorized");
    }
}
```

---

## âœ… ì •ë¦¬: ì–´ë–¤ ê¸°ëŠ¥ì´ ì¶”ê°€ëë‚˜?

| ì¶”ê°€ëœ ê¸°ëŠ¥           | ì„¤ëª…                          |
| ---------------- | --------------------------- |
| **CORS ì„¤ì •**      | í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œê°€ ë‹¤ë¥¸ ë„ë©”ì¸ì¼ ë•Œ ìš”ì²­ í—ˆìš© |
| **JWT ì¸ì¦ í•„í„° ì¶”ê°€** | ìš”ì²­ì—ì„œ í† í°ì„ êº¼ë‚´ ì¸ì¦ì„ ìˆ˜í–‰ (ì„¸ì…˜ ì—†ì´)  |
| **ì˜ˆì™¸ í•¸ë“¤ëŸ¬ ë“±ë¡**    | ì¸ì¦ ì‹¤íŒ¨ ì‹œ 401 ì—ëŸ¬ ì²˜ë¦¬ ë‹´ë‹¹        |

---

## ğŸ” ì „ì²´ êµ¬ì¡° ìš”ì•½

ì´ ë³´ì•ˆ ì„¤ì •ì€ **JWT ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œì„ ìœ„í•œ ì „í˜•ì ì¸ ë³´ì•ˆ êµ¬ì„±**ì…ë‹ˆë‹¤:

* `POST /login`: ë¡œê·¸ì¸ ì‹œ í† í° ë°œê¸‰
* ë‹¤ë¥¸ ìš”ì²­: í—¤ë”ì— í† í° í¬í•¨ â†’ `AuthenticationFilter`ê°€ ê²€ì¦ â†’ í†µê³¼ ì‹œ ì»¨íŠ¸ë¡¤ëŸ¬ ì ‘ê·¼ í—ˆìš©
* ì¸ì¦ ì‹¤íŒ¨: `AuthEntryPoint`ê°€ 401 ì‘ë‹µ
